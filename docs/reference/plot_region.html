<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot signal inside as well as around custom genomic regions — plot_region • GenomicPlot</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot signal inside as well as around custom genomic regions — plot_region"><meta property="og:description" content="Plot reads or peak Coverage/base/gene of samples given in the query files inside regions defined in the centerFiles. The upstream and downstream flanking windows can be given separately. If Input files are provided, ratio over Input is computed and displayed as well."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GenomicPlot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/GenomicPlot_vignettes.html">GenomicPlot: an R package for efficient and flexible visualization of NGS coverage profiles</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/shuye2009/GenomicPlot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot signal inside as well as around custom genomic regions</h1>
    <small class="dont-index">Source: <a href="https://github.com/shuye2009/GenomicPlot/blob/HEAD/R/GenomicPlot.R" class="external-link"><code>R/GenomicPlot.R</code></a></small>
    <div class="hidden name"><code>plot_region.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot reads or peak Coverage/base/gene of samples given in the query files inside regions defined in the centerFiles. The upstream and downstream flanking windows can be given separately. If Input files are provided, ratio over Input is computed and displayed as well.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_region</span><span class="op">(</span></span>
<span>  <span class="va">queryFiles</span>,</span>
<span>  <span class="va">centerFiles</span>,</span>
<span>  txdb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  regionName <span class="op">=</span> <span class="st">"region"</span>,</span>
<span>  inputFiles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nbins <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  importParams <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  heatmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fiveP <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>,</span>
<span>  threeP <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stranded <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  outPrefix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rmOutlier <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  heatRange <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Ylab <span class="op">=</span> <span class="st">"Coverage/base/gene"</span>,</span>
<span>  statsMethod <span class="op">=</span> <span class="st">"wilcox.test"</span>,</span>
<span>  hw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  nc <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>queryFiles</dt>
<dd><p>a named vector of sample file names. The file should be in .bam, .bed, .wig or .bw format, mixture of formats is allowed</p></dd>


<dt>centerFiles</dt>
<dd><p>a named vector of reference file names or genomic features in  c("utr3", "utr5", "cds", "intron", "exon", "transcript", "gene"). The file should be in .bed format only</p></dd>


<dt>txdb</dt>
<dd><p>a TxDb object defined in the GenomicFeatures package. Default NULL, needed only when genomic features are used in the place of centerFiles.</p></dd>


<dt>regionName</dt>
<dd><p>a string specifying the name of the center region in the plots</p></dd>


<dt>inputFiles</dt>
<dd><p>a named vector of input sample file names. The file should be in .bam, .bed, .wig or .bw format, mixture of formats is allowed</p></dd>


<dt>nbins</dt>
<dd><p>an integer defines the total number of bins</p></dd>


<dt>importParams</dt>
<dd><p>a list of parameters for <code>handle_input</code></p></dd>


<dt>verbose</dt>
<dd><p>logical, indicating whether to output additional information (data used for plotting or statistical test results)</p></dd>


<dt>scale</dt>
<dd><p>logical, indicating whether the score matrix should be scaled to the range 0:1, so that samples with different baseline can be compared</p></dd>


<dt>heatmap</dt>
<dd><p>logical, indicating whether a heatmap of the score matrix should be generated</p></dd>


<dt>fiveP</dt>
<dd><p>an integer, indicating extension out or inside of the 5' boundary of gene by negative or positive number</p></dd>


<dt>threeP</dt>
<dd><p>an integer, indicating extension out or inside of the 5' boundary of gene by positive or negative number</p></dd>


<dt>smooth</dt>
<dd><p>logical, indicating whether the line should smoothed with a spline smoothing algorithm</p></dd>


<dt>stranded</dt>
<dd><p>logical, indicating whether the strand of the feature should be considered</p></dd>


<dt>transform</dt>
<dd><p>a string in c("log", "log2", "log10"), default = NA indicating no transformation of data matrix</p></dd>


<dt>outPrefix</dt>
<dd><p>a string specifying output file prefix for plots (outPrefix.pdf)</p></dd>


<dt>rmOutlier</dt>
<dd><p>a numeric value serving as a multiplier of the MAD in Hampel filter for outliers identification, 0 indicating not removing outliers. For Gaussian distribution, use 3, adjust based on data distribution</p></dd>


<dt>heatRange</dt>
<dd><p>a numerical vector of two elements, defining range for heatmap color ramp generation</p></dd>


<dt>Ylab</dt>
<dd><p>a string for y-axis label</p></dd>


<dt>statsMethod</dt>
<dd><p>a string in c("wilcox.test", "t.test"), for pair-wise group comparisons</p></dd>


<dt>hw</dt>
<dd><p>a vector of two elements specifying the height and width of the output figures</p></dd>


<dt>nc</dt>
<dd><p>integer, number of cores for parallel processing</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a dataframe containing the data used for plotting</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Shuye Pu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">loadDb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"txdb_chr19.sql"</span>, package <span class="op">=</span> <span class="st">"GenomicPlot"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">queryfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"chip_treat_chr19.bam"</span>, package <span class="op">=</span> <span class="st">"GenomicPlot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">queryfiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"query"</span></span></span>
<span class="r-in"><span><span class="va">inputfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"chip_input_chr19.bam"</span>, package <span class="op">=</span> <span class="st">"GenomicPlot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inputfiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"input"</span></span></span>
<span class="r-in"><span><span class="va">centerfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_chip_peak_chr19.narrowPeak"</span>, package <span class="op">=</span> <span class="st">"GenomicPlot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">centerfiles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"narrowPeak"</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">importParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  offset <span class="op">=</span> <span class="fl">0</span>, fix_width <span class="op">=</span> <span class="fl">150</span>, fix_point <span class="op">=</span> <span class="st">"start"</span>, norm <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  useScore <span class="op">=</span> <span class="cn">FALSE</span>, outRle <span class="op">=</span> <span class="cn">TRUE</span>, useSizeFactor <span class="op">=</span> <span class="cn">TRUE</span>, genome <span class="op">=</span> <span class="st">"hg19"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_region</span><span class="op">(</span></span></span>
<span class="r-in"><span>  queryFiles <span class="op">=</span> <span class="va">queryfiles</span>, centerFiles <span class="op">=</span> <span class="va">centerfiles</span>, txdb <span class="op">=</span> <span class="cn">NULL</span>, regionName <span class="op">=</span> <span class="st">"region"</span>,</span></span>
<span class="r-in"><span>  inputFiles <span class="op">=</span> <span class="va">inputfiles</span>, nbins <span class="op">=</span> <span class="fl">100</span>, importParams <span class="op">=</span> <span class="va">importParams</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="cn">FALSE</span>, heatmap <span class="op">=</span> <span class="cn">TRUE</span>, fiveP <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, threeP <span class="op">=</span> <span class="fl">1000</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span>, stranded <span class="op">=</span> <span class="cn">TRUE</span>, transform <span class="op">=</span> <span class="st">"log2"</span>,</span></span>
<span class="r-in"><span>  outPrefix <span class="op">=</span> <span class="cn">NULL</span>, rmOutlier <span class="op">=</span> <span class="fl">0</span>, heatRange <span class="op">=</span> <span class="cn">NULL</span>, Ylab <span class="op">=</span> <span class="st">"Coverage/base/gene"</span>,</span></span>
<span class="r-in"><span>  statsMethod <span class="op">=</span> <span class="st">"wilcox.test"</span>, nc <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading bamfile: C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/chip_treat_chr19.bam</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Paired end bam file detected!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bam file C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/chip_treat_chr19.bam is loaded</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cached .rds file is modified using new input parameters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading bamfile: C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/chip_input_chr19.bam</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Paired end bam file detected!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bam file C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/chip_input_chr19.bam is loaded</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cached .rds file is modified using new input parameters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading bedfile: C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/test_chip_peak_chr19.narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The input file C:/Users/greenblatt/AppData/Local/Temp/RtmpiQE4hr/temp_libpath167c637a5c73/GenomicPlot/extdata/test_chip_peak_chr19.narrowPeak have more than 6 columns, only the first 6 columns will be used!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cached .rds file is modified using new input parameters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing coverage for sample...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query label: query</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Center label: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: -1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: region</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: 1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query label: input</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Center label: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: -1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: region</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: 1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting coverage profiles...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query label: query</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Center label: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Inspecting matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          n_invalid fraction_invalid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> infinite         0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA               0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NaN              0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zero        559199        0.7038376</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing missing values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quartiles:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 0 0 7.0281865421272 2030.69409868277</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quantiles after imputing:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0.0277274801288241 0.0277274801288241 0.0277274801288241 7.0281865421272 2030.69409868277</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The imputed value is: 0.0277274801288241</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: -1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: region</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: 1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Drawing heatmap</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> quantile(fullMatrix, c(seq(0.9, 1, 0.005)), na.rm=TRUE)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 9.91978329088811 11.4459037971786 12.9720243034691 14.4008920323979 15.7748033102141 17.3268859257092 18.9091685538184 19.076506328631 19.076506328631 19.076506328631 19.076506328631 19.076506328631 22.0113534561127 25.24513550115 28.6147594929465 28.6147594929465 34.7290243418666 39.6204362210028 48.9220081653601 71.894583226028 2030.69409868277</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `use_raster` is automatically set to TRUE for a matrix with more than</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2000 rows. You can control `use_raster` argument by explicitly setting</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRUE/FALSE to it.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>implicit list embedding of S4 objects is deprecated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query label: input</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Center label: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Inspecting matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          n_invalid fraction_invalid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> infinite         0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA               0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NaN              0        0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zero        617165        0.7767967</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing missing values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quartiles:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 0 0 0 2381.26891525185</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quantiles after imputing:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0.0210222020521201 0.0210222020521201 0.0210222020521201 0.0210222020521201 2381.26891525185</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The imputed value is: 0.0210222020521201</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: -1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: region</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: 1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Drawing heatmap</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> quantile(fullMatrix, c(seq(0.9, 1, 0.005)), na.rm=TRUE)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 7.82025916338868 8.78064186766448 11.0285706150353 13.4508457610285 15.6405183267774 15.6405183267774 15.6405183267774 18.0760065819617 2381.26891525185</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `use_raster` is automatically set to TRUE for a matrix with more than</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2000 rows. You can control `use_raster` argument by explicitly setting</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRUE/FALSE to it.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>implicit list embedding of S4 objects is deprecated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beds: query</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Centers: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beds: input</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Centers: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beds: query input</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Centers: narrowPeak</span>
<span class="r-plt img"><img src="plot_region-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_region-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_region-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Max(IP)   min(Input)       pseudo </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2030.6940987    0.0210222    1.0000000 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Inspecting matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          n_invalid fraction_invalid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> infinite         0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA               0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NaN              0                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zero             0                0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Imputing missing values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quartiles:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0.025628286048916 1.00656722063754 1.00656722063754 1.31911487027852 458.121619806466</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matrix quantiles after imputing:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0.025628286048916 1.00656722063754 1.00656722063754 1.31911487027852 458.121619806466</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The imputed value is: 0.012814143024458</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting coverage profiles...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ratio label: query</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Center label: narrowPeak</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: -1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: region</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Feature name: 1K</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Drawing heatmap</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> quantile(fullMatrix, c(seq(0.9, 1, 0.005)), na.rm=TRUE)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3.36754960066551 3.36754960066551 3.36754960066551 3.36754960066551 3.36754960066551 3.36754960066551 3.36754960066551 3.36754960066551 3.60758485684757 3.82577283303868 4.02236889314674 4.20301015811094 4.29742209340991 4.29742209340991 4.29742209340991 4.323546345804 4.63697971277802 4.85823022681547 5.13694783145658 5.57557686371549 8.83958683831407</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `use_raster` is automatically set to TRUE for a matrix with more than</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2000 rows. You can control `use_raster` argument by explicitly setting</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRUE/FALSE to it.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>implicit list embedding of S4 objects is deprecated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Beds: query</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Centers: narrowPeak</span>
<span class="r-plt img"><img src="plot_region-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_region-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Shuye Pu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

